<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Celebra√ß√£o - Login</title>
<style>
/* --- SEU CSS ORIGINAL (inalterado) --- */
*{
 margin:0;
 padding:0;
 box-sizing:border-box;
 font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;
}
body{
 min-height:100vh;
 background:linear-gradient(135deg,#ff8a00 0%,#ffb347 50%,#ffd194 100%);
 padding:30px 16px;
}
.container{max-width:820px;margin:auto;text-align:center;}
.title{font-size:64px;font-weight:900;color:#fff;margin-bottom:35px;}
.login-section,.recovery-section,.upload-section{
 background:#fff;border-radius:16px;padding:40px 30px;
 box-shadow:0 10px 25px rgba(0,0,0,.08);
}
.login-title{font-size:22px;font-weight:700;margin-bottom:24px;}
.login-form{display:flex;flex-direction:column;gap:16px;max-width:380px;margin:auto;}
.form-label{font-size:13px;font-weight:600;text-align:left;}
.form-input{padding:12px 14px;border-radius:10px;border:1px solid #e5e7eb;font-size:15px;}
.login-btn,.upload-btn,.logout-btn,.back-btn{
 border:none;border-radius:12px;padding:14px;font-size:15px;font-weight:700;cursor:pointer;
}
.login-btn,.upload-btn{background:#fb923c;color:#fff;}
.logout-btn{background:#ef4444;color:#fff;margin-top:25px;}
.back-btn{background:#6b7280;color:#fff;margin-top:15px;}
.error-message{color:#dc2626;font-size:13px;display:none;}
.success-message{color:#16a34a;font-size:13px;display:none;}
</style>
</head>

<body>
<div class="container">
 <div class="title">CELEBRA√á√ÉO</div>

 <div class="login-section" id="loginSection">
  <h2 class="login-title">üîí Acesso</h2>
  <form class="login-form" id="loginForm">
   <label class="form-label">Usu√°rio</label>
   <input id="username" class="form-input" required>

   <label class="form-label">Senha</label>
   <input type="password" id="password" class="form-input" required>

   <button type="submit" class="login-btn">Entrar</button>
   <p class="error-message" id="errorMessage">‚ùå Usu√°rio ou senha incorretos</p>
  </form>
 </div>

 <div class="upload-section" id="uploadSection" style="display:none">
  <p>üë§ Usu√°rio: <strong id="loggedUser"></strong></p>
  <button class="logout-btn" onclick="logout()">Sair</button>
 </div>
</div>

<script type="module">
import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js'
import { getFirestore, doc, getDoc, setDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js'

const firebaseConfig = {
  apiKey: "AIzaSyCgglak6eKX53K1rUGHYS7KGD9smWz91ls",
  authDomain: "loginadsite.firebaseapp.com",
  projectId: "loginadsite",
  storageBucket: "loginadsite.appspot.com",
  messagingSenderId: "671226504800",
  appId: "1:671226504800:web:bc26b4795ede46ab8a8505"
}

const app = initializeApp(firebaseConfig)
const db = getFirestore(app)

/* üîê BUSCA USU√ÅRIO (CORRIGIDO) */
async function getUser(username) {
  const snap = await getDoc(doc(db, "users", username))
  if (!snap.exists()) return null
  const data = snap.data()
  return data.password ?? null
}

/* üíæ SALVA SENHA (SEM APAGAR OUTROS CAMPOS) */
async function saveUser(username, password) {
  await setDoc(
    doc(db, "users", username),
    {
      password,
      updatedAt: new Date().toISOString()
    },
    { merge: true }
  )
}

loginForm.onsubmit = async (e) => {
  e.preventDefault()
  const u = username.value.toLowerCase().trim()
  const p = password.value

  const stored = await getUser(u)

  if (stored && stored === p) {
    sessionStorage.setItem("user", u)
    document.getElementById("loggedUser").textContent = u
    loginSection.style.display = "none"
    uploadSection.style.display = "block"
  } else {
    errorMessage.style.display = "block"
  }
}

window.logout = () => {
  sessionStorage.clear()
  location.reload()
}
</script>
</body>
</html>
